
# AUTOMATICALLY GENERATED
# DO NOT EDIT THIS FILE DIRECTLY, USE /templates/conf/fluent.conf.erb

@include "#{ENV['FLUENTD_SYSTEMD_CONF'] || 'systemd'}.conf"
@include "#{ENV['FLUENTD_PROMETHEUS_CONF'] || 'prometheus'}.conf"
@include kubernetes.conf
@include conf.d/*.conf

<match **>
  @type mongo
  @id out_mongo
  @log_level "#{ENV['FLUENT_LOG_LEVEL'] || 'info'}"
  include_tag_key true
  connection_string "#{ENV['FLUENT_MONGO_PROTOCOL'] || 'mongodb'}://#{ENV['FLUENT_MONGO_USER']}:#{ENV['FLUENT_MONGO_PASSWORD']}@#{ENV['FLUENT_MONGO_ENDPOINT']}/#{ENV['FLUENT_MONGO_DB']}?#{ENV['FLUENT_MONGO_URL_OPTIONS']}"
  collection "#{ENV['FLUENT_MONGO_COLLECTION'] || 'logs'}"
  <buffer>
    flush_thread_count "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_THREAD_COUNT'] || '1'}"
    flush_mode "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_MODE'] || 'interval'}"
    flush_interval "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_INTERVAL'] || '60s'}"
    chunk_limit_size "#{ENV['FLUENT_MONGO_BUFFER_CHUNK_LIMIT_SIZE'] || '8M'}"
    total_limit_size "#{ENV['FLUENT_MONGO_BUFFER_TOTAL_LIMIT_SIZE'] || '512M'}"
    retry_max_interval "#{ENV['FLUENT_MONGO_BUFFER_RETRY_MAX_INTERVAL'] || '30'}"
    retry_timeout "#{ENV['FLUENT_MONGO_BUFFER_RETRY_TIMEOUT'] || '72h'}"
    retry_forever "#{ENV['FLUENT_MONGO_BUFFER_RETRY_FOREVER'] || 'false'}"
  </buffer>
</match>